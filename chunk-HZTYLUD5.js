import{a as Q}from"./chunk-JEO34WBT.js";import{a as V,b,c as D,d as A,e as G,f as j,g as q,h as W,i as B,j as L,k as R,l as $,m as H,n as J}from"./chunk-OWGPU7TU.js";import{d as F}from"./chunk-KRWS2OF2.js";import{a as K}from"./chunk-CTGI6UYM.js";import{$a as O,Ab as N,Cb as z,Ea as C,Eb as y,Ha as m,Ia as S,Ja as t,Ka as e,La as x,Ma as h,Na as c,Oa as p,S as _,Sa as o,Ta as u,Ua as k,W as P,Wa as v,Xa as E,Ya as M,_a as T,ca as g,da as f,pa as w,ta as l,zb as I}from"./chunk-MMXZZOCS.js";var U=()=>({standalone:!0});function Z(a,r){a&1&&(t(0,"p"),o(1,"Cargando empleados..."),e())}function ee(a,r){if(a&1&&(t(0,"p",16),o(1),e()),a&2){let n=p();l(),u(n.error)}}function te(a,r){if(a&1){let n=h();t(0,"tr")(1,"td"),o(2),e(),t(3,"td"),o(4),e(),t(5,"td"),o(6),e(),t(7,"td"),o(8),e(),t(9,"td")(10,"span",19),o(11),e()(),t(12,"td",20)(13,"button",21),c("click",function(){let d=g(n).$implicit,s=p(2);return f(s.verDocumentos(d))}),o(14,"Documentos"),e(),t(15,"button",22),c("click",function(){let d=g(n).$implicit,s=p(2);return f(s.openModalEditar(d))}),o(16,"Editar"),e(),t(17,"button",23),c("click",function(){let d=g(n).$implicit,s=p(2);return f(s.confirmarEliminar(d))}),o(18,"Eliminar"),e()()()}if(a&2){let n=r.$implicit;l(2),u(n.nombre),l(2),u(n.cedula),l(2),u(n.cargo||"-"),l(2),u(n.correo||"-"),l(2),S("activo",n.estado==="activo"),l(),k(" ",n.estado," ")}}function oe(a,r){if(a&1&&(t(0,"div",17)(1,"table")(2,"thead")(3,"tr")(4,"th"),o(5,"Nombre"),e(),t(6,"th"),o(7,"Cedula"),e(),t(8,"th"),o(9,"Cargo"),e(),t(10,"th"),o(11,"Correo"),e(),t(12,"th"),o(13,"Estado"),e(),t(14,"th"),o(15,"Acciones"),e()()(),t(16,"tbody"),C(17,te,19,7,"tr",18),e()()()),a&2){let n=p();l(17),m("ngForOf",n.empleadosFiltrados)}}function ne(a,r){a&1&&(t(0,"p"),o(1," No hay empleados registrados. "),e())}function re(a,r){a&1&&(t(0,"p"),o(1," No se encontraron empleados con esos filtros. "),e())}function ie(a,r){if(a&1){let n=h();t(0,"div",24)(1,"div",25)(2,"div",26)(3,"h3"),o(4),e(),t(5,"button",27),c("click",function(){g(n);let d=p();return f(d.closeModal())}),o(6,"x"),e()(),t(7,"form",28),c("ngSubmit",function(){g(n);let d=p();return f(d.submit())}),t(8,"div",29)(9,"label"),o(10,"Nombre"),e(),x(11,"input",30),e(),t(12,"div",29)(13,"label"),o(14,"Cedula"),e(),x(15,"input",31),e(),t(16,"div",29)(17,"label"),o(18,"Cargo"),e(),x(19,"input",32),e(),t(20,"div",29)(21,"label"),o(22,"Correo"),e(),x(23,"input",33),e(),t(24,"div",29)(25,"label"),o(26,"Estado"),e(),t(27,"select",34)(28,"option",9),o(29,"Activo"),e(),t(30,"option",10),o(31,"Inactivo"),e()()(),t(32,"div",35)(33,"button",11),c("click",function(){g(n);let d=p();return f(d.closeModal())}),o(34," Cancelar "),e(),t(35,"button",36),o(36," Guardar "),e()()()()()}if(a&2){let n=p();l(4),u(n.modoEdicion?"Editar empleado":"Nuevo empleado"),l(3),m("formGroup",n.form),l(28),m("disabled",n.form.invalid||n.loading)}}var X=class a{fb=_($);empleadosService=_(K);toast=_(Q);platformId=_(w);router=_(F);form;empleados=[];filtroTexto="";filtroEstado="todos";loading=!0;error="";showModal=!1;modoEdicion=!1;empleadoEditando=null;ngOnInit(){if(this.form=this.fb.group({id:[null],nombre:["",b.required],cedula:["",b.required],cargo:[""],correo:["",[b.required,b.email]],estado:["activo",b.required]}),!y(this.platformId)){this.loading=!1;return}this.cargarEmpleados()}cargarEmpleados(){this.loading=!0,this.empleadosService.getEmpleados().subscribe({next:r=>{this.empleados=r,this.loading=!1},error:()=>{this.toast.error("No se pudieron cargar los empleados"),this.loading=!1}})}get empleadosFiltrados(){let r=this.normalizarTexto(this.filtroTexto.trim()),n=this.filtroEstado;return this.empleados.filter(i=>{let d=n==="todos"||i.estado===n;if(!r)return d;let s=[i.nombre,i.cedula,i.cargo,i.correo].map(Y=>this.normalizarTexto(Y)).join(" ");return d&&s.includes(r)})}limpiarFiltros(){this.filtroTexto="",this.filtroEstado="todos"}normalizarTexto(r){return String(r??"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}retornar(){y(this.platformId)&&window.history.back()}verDocumentos(r){r?.id&&this.router.navigate(["/documentos"],{queryParams:{empleado_id:r.id}})}confirmarEliminar(r){confirm(`\xBFSeguro que deseas eliminar a ${r.nombre}?`)&&this.eliminarEmpleado(r.id)}eliminarEmpleado(r){this.empleadosService.eliminarEmpleado(r).subscribe({next:()=>{this.toast.success("Empleado eliminado correctamente"),this.cargarEmpleados()},error:()=>{this.toast.error("No se pudo eliminar el empleado")}})}openModalCrear(){this.modoEdicion=!1,this.empleadoEditando=null,this.form.reset({estado:"activo"}),this.showModal=!0}openModalEditar(r){this.modoEdicion=!0,this.empleadoEditando=r,this.form.patchValue(r),this.showModal=!0}closeModal(){this.showModal=!1,this.modoEdicion=!1,this.empleadoEditando=null,this.form.reset({estado:"activo"})}submit(){if(this.form.invalid){this.form.markAllAsTouched();return}let r=this.form.value;this.modoEdicion?this.empleadosService.actualizarEmpleado(r.id,r).subscribe({next:()=>{this.toast.success("Empleado actualizado correctamente"),this.closeModal(),this.cargarEmpleados()},error:n=>{console.error(n),this.toast.error(n?.error?.message||"Error al actualizar el empleado")}}):this.empleadosService.crearEmpleado(r).subscribe({next:()=>{this.toast.success("Empleado creado correctamente"),this.closeModal(),this.cargarEmpleados()},error:()=>{this.toast.error("Error al crear el empleado")}})}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=P({type:a,selectors:[["app-empleados"]],standalone:!0,features:[T],decls:26,vars:12,consts:[[1,"page"],[1,"page-header"],[1,"page-header-left"],["type","button",1,"btn-retorno",3,"click"],[1,"primary",3,"click"],[1,"filtros"],["type","text","placeholder","Buscar por nombre, cedula, cargo o correo",3,"ngModelChange","ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"],["value","todos"],["value","activo"],["value","inactivo"],["type","button",1,"secondary",3,"click"],[4,"ngIf"],["class","error",4,"ngIf"],["class","table-wrapper",4,"ngIf"],["class","modal-backdrop",4,"ngIf"],[1,"error"],[1,"table-wrapper"],[4,"ngFor","ngForOf"],[1,"badge"],[1,"acciones"],[1,"btn-documentos",3,"click"],[1,"secondary",3,"click"],[1,"btn-eliminar",3,"click"],[1,"modal-backdrop"],[1,"modal"],[1,"modal-header"],["type","button",1,"close",3,"click"],[1,"modal-body",3,"ngSubmit","formGroup"],[1,"field"],["type","text","placeholder","Nombre completo","formControlName","nombre"],["type","text","formControlName","cedula"],["type","text","formControlName","cargo"],["type","email","formControlName","correo"],["formControlName","estado"],[1,"modal-footer"],["type","submit",1,"primary",3,"disabled"]],template:function(n,i){n&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),c("click",function(){return i.retornar()}),o(4," Retornar "),e(),t(5,"h2"),o(6,"Empleados"),e()(),t(7,"button",4),c("click",function(){return i.openModalCrear()}),o(8,"+ Nuevo empleado"),e()(),t(9,"div",5)(10,"input",6),M("ngModelChange",function(s){return E(i.filtroTexto,s)||(i.filtroTexto=s),s}),e(),t(11,"select",7),M("ngModelChange",function(s){return E(i.filtroEstado,s)||(i.filtroEstado=s),s}),t(12,"option",8),o(13,"Todos los estados"),e(),t(14,"option",9),o(15,"Activos"),e(),t(16,"option",10),o(17,"Inactivos"),e()(),t(18,"button",11),c("click",function(){return i.limpiarFiltros()}),o(19," Limpiar "),e()(),C(20,Z,2,0,"p",12)(21,ee,2,1,"p",13)(22,oe,18,1,"div",14)(23,ne,2,0,"p",12)(24,re,2,0,"p",12),e(),C(25,ie,37,3,"div",15)),n&2&&(l(10),v("ngModel",i.filtroTexto),m("ngModelOptions",O(10,U)),l(),v("ngModel",i.filtroEstado),m("ngModelOptions",O(11,U)),l(9),m("ngIf",i.loading),l(),m("ngIf",i.error),l(),m("ngIf",!i.loading&&i.empleadosFiltrados.length),l(),m("ngIf",!i.loading&&!i.empleados.length),l(),m("ngIf",!i.loading&&i.empleados.length&&!i.empleadosFiltrados.length),l(),m("ngIf",i.showModal))},dependencies:[z,I,N,J,j,L,R,V,B,D,A,q,W,H,G],styles:[".page[_ngcontent-%COMP%]{background:var(--surface);border:1px solid var(--border);box-shadow:var(--shadow-sm);padding:1.15rem;border-radius:16px}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:.75rem;margin-bottom:.95rem}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.55rem}.page-header[_ngcontent-%COMP%]   .primary[_ngcontent-%COMP%]{border:none;border-radius:10px;padding:.55rem .95rem;cursor:pointer;font-size:.86rem;font-weight:700;color:#191919;background:linear-gradient(135deg,var(--brand-yellow) 0%,var(--brand-yellow-strong) 100%)}.page-header[_ngcontent-%COMP%]   .primary[_ngcontent-%COMP%]:hover{box-shadow:0 10px 16px #11111126}.page-header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.65rem}.btn-retorno[_ngcontent-%COMP%]{border:1px solid #2d2d2d;background:#fff;color:#1a1a1a;border-radius:9px;padding:.42rem .75rem;font-size:.81rem;font-weight:700;cursor:pointer}.btn-retorno[_ngcontent-%COMP%]:hover{background:#f2f2ed}.filtros[_ngcontent-%COMP%]{display:flex;gap:.6rem;margin-bottom:1rem;align-items:center;flex-wrap:wrap;padding:.75rem;border:1px solid var(--border);background:var(--surface-soft);border-radius:12px}.filtros[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filtros[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.53rem .63rem;border:1px solid var(--border);border-radius:9px;font-size:.88rem;background:#fff}.filtros[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{min-width:250px;flex:1 1 250px}.filtros[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-width:165px}.table-wrapper[_ngcontent-%COMP%]{overflow-x:auto;border:1px solid var(--border);border-radius:12px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.9rem}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;background:#1f1f1f;color:#f6f6f6;padding:.68rem;border-bottom:1px solid #303030;font-weight:600}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.66rem;border-bottom:1px solid #ecece4;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#fffde8}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border-radius:999px;font-size:.73rem;padding:.18rem .62rem;text-transform:capitalize;font-weight:700;background:#f0f0ec;color:#404040}.badge.activo[_ngcontent-%COMP%]{background:#dbffe8;color:#0f7a45}.error[_ngcontent-%COMP%]{color:var(--danger);font-size:.86rem;margin-bottom:.7rem}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0c0c0c94;display:flex;align-items:center;justify-content:center;z-index:1000;padding:.8rem}.modal[_ngcontent-%COMP%]{background:#fff;width:min(500px,100%);border-radius:14px;border:1px solid var(--border);overflow:hidden;box-shadow:var(--shadow-lg)}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.8rem 1rem;background:#1a1a1a;color:#f8f8f8}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem}.modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background:transparent;border:none;color:#f8f8f8;font-size:1.4rem;cursor:pointer;line-height:1}.modal-body[_ngcontent-%COMP%]{padding:.95rem 1rem}.modal-body[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:.82rem}.modal-body[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.78rem;margin-bottom:.24rem;color:var(--text-soft);font-weight:600}.modal-body[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.52rem .58rem;border-radius:9px;border:1px solid var(--border);font-size:.87rem;background:#fcfcfa}.modal-body[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .modal-body[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#a69000;box-shadow:0 0 0 3px #f7db2138}.modal-footer[_ngcontent-%COMP%]{padding:.85rem 1rem;display:flex;justify-content:flex-end;gap:.52rem;border-top:1px solid var(--border);background:#fafaf5}.secondary[_ngcontent-%COMP%]{background:#ebebe3;color:#1f1f1f;border:1px solid #d8d8cf;padding:.45rem .85rem;border-radius:9px;cursor:pointer;font-size:.82rem;font-weight:600}.secondary[_ngcontent-%COMP%]:hover{background:#e1e1d8}.acciones[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.45rem;flex-wrap:wrap}.btn-documentos[_ngcontent-%COMP%]{background:#1f1f1f;color:#fff;border:1px solid #1f1f1f;border-radius:9px;padding:.45rem .72rem;font-size:.8rem;font-weight:600;cursor:pointer}.btn-documentos[_ngcontent-%COMP%]:hover{background:#000}.btn-eliminar[_ngcontent-%COMP%]{background:transparent;color:var(--danger);border:1px solid var(--danger);border-radius:7px;padding:.34rem .52rem;font-size:.75rem;cursor:pointer}.btn-eliminar[_ngcontent-%COMP%]:hover{background:var(--danger);color:#fff}@media (max-width: 760px){.page[_ngcontent-%COMP%]{padding:.82rem}.page-header[_ngcontent-%COMP%]{align-items:flex-start;flex-direction:column}table[_ngcontent-%COMP%]{font-size:.82rem}}"]})};export{X as EmpleadosComponent};
